{% extends 'base.html' %}

{% block content %}
  <div class="container mt-5">
    <div class="row">
      <div class="col-md-8 offset-md-2">
        <h2 class="mb-4">게시물 삭제</h2>
        <p>정말로 이 게시물을 삭제하시겠습니까?</p>
        <form method="post" id="deleteForm">
          {% csrf_token %}
          <div class="form-group">
            <label for="password">게시물 비밀번호</label>
            <input type="password" class="form-control" id="password" name="password">
          </div>
          <button type="button" class="btn btn-danger" onclick="checkPassword()"><i class="bi bi-trash"></i> 삭제</button>
          <a href="{{ post.get_absolute_url }}" class="btn btn-secondary"><i class="bi bi-arrow-left"></i> 취소</a>
        </form>
      </div>
    </div>
  </div>

  <script>
    function checkPassword() {
      var password = document.getElementById("password").value;

      // Ajax를 사용하여 서버에 비밀번호 확인 요청
      // 여기서는 비동기적인 요청을 모의로 구현한 것이므로 실제 서버에 맞게 수정해야 합니다.
      // 예: 비밀번호가 일치하면 삭제 처리, 불일치하면 에러 메시지 반환

      // 비밀번호가 일치하지 않는 경우
      // 여기서는 예시로 간단한 alert을 사용했지만, 실제 프로젝트에서는 더 나은 방식으로 사용자에게 알림을 표시해야 합니다.
      if (password !== "{{ post.password }}") {
        alert("비밀번호가 틀렸습니다.");
      } else {
        // 비밀번호가 일치하는 경우 폼 제출
        document.getElementById("deleteForm").submit();
      }
    }
  </script>
{% endblock %}
